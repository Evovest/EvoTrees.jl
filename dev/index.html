<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · EvoTrees.jl</title><meta name="title" content="Introduction · EvoTrees.jl"/><meta property="og:title" content="Introduction · EvoTrees.jl"/><meta property="twitter:title" content="Introduction · EvoTrees.jl"/><meta name="description" content="Documentation for EvoTrees.jl."/><meta property="og:description" content="Documentation for EvoTrees.jl."/><meta property="twitter:description" content="Documentation for EvoTrees.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="EvoTrees.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Quick-start"><span>Quick start</span></a></li><li><a class="tocitem" href="#Reproducibility"><span>Reproducibility</span></a></li><li><a class="tocitem" href="#Missing-values"><span>Missing values</span></a></li><li><a class="tocitem" href="#Save/Load"><span>Save/Load</span></a></li></ul></li><li><a class="tocitem" href="models/">Models</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="api/">Public</a></li><li><a class="tocitem" href="internals/">Internals</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="tutorials/regression-boston/">Regression - Boston</a></li><li><a class="tocitem" href="tutorials/logistic-regression-titanic/">Logistic Regression - Titanic</a></li><li><a class="tocitem" href="tutorials/classification-iris/">Classification - IRIS</a></li><li><a class="tocitem" href="tutorials/ranking-LTRC/">Ranking - Yahoo! LTRC</a></li><li><a class="tocitem" href="tutorials/examples-API/">Internal API</a></li><li><a class="tocitem" href="tutorials/examples-MLJ/">MLJ API</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Evovest/EvoTrees.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Evovest/EvoTrees.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="[EvoTrees.jl](https://github.com/Evovest/EvoTrees.jl)"><a class="docs-heading-anchor" href="#[EvoTrees.jl](https://github.com/Evovest/EvoTrees.jl)"><a href="https://github.com/Evovest/EvoTrees.jl">EvoTrees.jl</a></a><a id="[EvoTrees.jl](https://github.com/Evovest/EvoTrees.jl)-1"></a><a class="docs-heading-anchor-permalink" href="#[EvoTrees.jl](https://github.com/Evovest/EvoTrees.jl)" title="Permalink"></a></h1><p>A Julia implementation of boosted trees with CPU and GPU support. Efficient histogram based algorithms with support for multiple loss functions, including various regressions, multi-classification and Gaussian max likelihood. </p><p>See the <code>examples-API</code> section to get started using the internal API, or <code>examples-MLJ</code> to use within the <a href="https://github.com/alan-turing-institute/MLJ.jl">MLJ</a> framework.</p><p>Complete details about hyper-parameters are found in the <code>Models</code> section.</p><p><a href="https://github.com/Evovest/EvoTrees">R binding available</a>.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Latest:</p><pre><code class="language-julia-repl hljs">julia&gt; Pkg.add(url=&quot;https://github.com/Evovest/EvoTrees.jl&quot;)</code></pre><p>From General Registry:</p><pre><code class="language-julia-repl hljs">julia&gt; Pkg.add(&quot;EvoTrees&quot;)</code></pre><h2 id="Quick-start"><a class="docs-heading-anchor" href="#Quick-start">Quick start</a><a id="Quick-start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-start" title="Permalink"></a></h2><p>A model configuration must first be defined, using one of the model constructor: </p><ul><li><a href="models/#EvoTrees.EvoTreeRegressor"><code>EvoTreeRegressor</code></a></li><li><a href="models/#EvoTrees.EvoTreeClassifier"><code>EvoTreeClassifier</code></a></li><li><a href="models/#EvoTrees.EvoTreeCount"><code>EvoTreeCount</code></a></li><li><a href="models/#EvoTrees.EvoTreeMLE"><code>EvoTreeMLE</code></a></li></ul><p>Then fitting can be performed using <a href="api/#EvoTrees.fit_evotree"><code>fit_evotree</code></a>. 2 broad methods are supported: Matrix and Tables based inputs. Optional kwargs can be used to specify eval data on which to track eval metric and perform early stopping. Look at the docs for more details on available hyper-parameters for each of the above constructors and other options for training.</p><p>Predictions are obtained by passing features data to the model. Model acts as a functor, ie. it&#39;s a struct containing the fitted model as well as a function generating the prediction of that model for the features argument. </p><h3 id="Matrix-features-input"><a class="docs-heading-anchor" href="#Matrix-features-input">Matrix features input</a><a id="Matrix-features-input-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-features-input" title="Permalink"></a></h3><pre><code class="language-julia hljs">using EvoTrees

config = EvoTreeRegressor(
    loss=:mse, 
    nrounds=100, 
    max_depth=6,
    nbins=32,
    eta=0.1)

x_train, y_train = rand(1_000, 10), rand(1_000)
m = fit_evotree(config; x_train, y_train)
preds = m(x_train)</code></pre><h3 id="Tables-and-DataFrames-input"><a class="docs-heading-anchor" href="#Tables-and-DataFrames-input">Tables and DataFrames input</a><a id="Tables-and-DataFrames-input-1"></a><a class="docs-heading-anchor-permalink" href="#Tables-and-DataFrames-input" title="Permalink"></a></h3><p>When using a <code>Tables</code> compatible input such as <code>DataFrames</code>, features with element type <code>Real</code> (incl. <code>Bool</code>) and <code>Categorical</code> are automatically recognized as input features. Alternatively, <code>fnames</code> kwarg can be used. </p><p><code>Categorical</code> features are treated accordingly by the algorithm. Ordered variables will be treated as numerical features, using <code>≤</code> split rule, while unordered variables are using <code>==</code>. Support is currently limited to a maximum of 255 levels. <code>Bool</code> variables are treated as unordered, 2-levels cat variables.</p><pre><code class="language-julia hljs">dtrain = DataFrame(x_train, :auto)
dtrain.y .= y_train
m = fit_evotree(config, dtrain; target_name=&quot;y&quot;);
m = fit_evotree(config, dtrain; target_name=&quot;y&quot;, fnames=[&quot;x1&quot;, &quot;x3&quot;]);</code></pre><h3 id="GPU-Acceleration"><a class="docs-heading-anchor" href="#GPU-Acceleration">GPU Acceleration</a><a id="GPU-Acceleration-1"></a><a class="docs-heading-anchor-permalink" href="#GPU-Acceleration" title="Permalink"></a></h3><p>EvoTrees supports training and inference on Nvidia GPU&#39;s with <a href="https://github.com/JuliaGPU/CUDA.jl">CUDA.jl</a>. Note that on Julia ≥ 1.9 CUDA support is only enabled when CUDA.jl is installed and loaded, by another package or explicitly with e.g.</p><pre><code class="language-julia hljs">using CUDA</code></pre><p>If running on a CUDA enabled machine, training and inference on GPU can be triggered through the <code>device</code> kwarg: </p><pre><code class="language-julia hljs">m = fit_evotree(config, dtrain; target_name=&quot;y&quot;, device=&quot;gpu&quot;);
p = m(dtrain; device=&quot;gpu&quot;)</code></pre><h2 id="Reproducibility"><a class="docs-heading-anchor" href="#Reproducibility">Reproducibility</a><a id="Reproducibility-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducibility" title="Permalink"></a></h2><p>EvoTrees models trained on cpu can be fully reproducible.</p><p>Models of the gradient boosting family typically involve some stochasticity.  In EvoTrees, this primarily concern the the 2 subsampling parameters <code>rowsample</code> and <code>colsample</code>. The other stochastic operation happens at model initialisation when the features are binarized to allow for fast histogram construction: a random subsample of <code>1_000 * nbins</code> is used to compute the breaking points. </p><p>These random parts of the algorithm can be deterministically reproduced on cpu by specifying an <code>rng</code> to the model constructor. <code>rng</code> can be an integer (ex: <code>123</code>) or a random generator (ex: <code>Random.Xoshiro(123)</code>).  If no <code>rng</code> is specified, <code>123</code> is used by default. When an integer <code>rng</code> is used, a <code>Random.MersenneTwister</code> generator will be created by the EvoTrees&#39;s constructor. Otherwise, the provided random generator will be used.  </p><p>Consequently, the following <code>m1</code> and <code>m2</code> models will be identical:</p><pre><code class="language-julia hljs">config = EvoTreeRegressor(rowsample=0.5, rng=123)
m1 = fit_evotree(config, df; target_name=&quot;y&quot;);
config = EvoTreeRegressor(rowsample=0.5, rng=123)
m2 = fit_evotree(config, df; target_name=&quot;y&quot;);</code></pre><p>However, the following <code>m1</code> and <code>m2</code> models won&#39;t be because the there&#39;s stochasticity involved in the model from <code>rowsample</code> and the random generator in the <code>config</code> isn&#39;t reset between the fits:</p><pre><code class="language-julia hljs">config = EvoTreeRegressor(rowsample=0.5, rng=123)
m1 = fit_evotree(config, df; target_name=&quot;y&quot;);
m2 = fit_evotree(config, df; target_name=&quot;y&quot;);</code></pre><p>Note that in presence of multiple identical or very highly correlated features, model may not be reproducible if features are permuted since in situation where 2 features provide identical gains, the first one will be selected. Therefore, if the identity relationship doesn&#39;t hold on new data, different predictions will be returned from models trained on different features order. </p><p>At the moment, there&#39;s no reproducibility guarantee on GPU, although this may change in the future. </p><h2 id="Missing-values"><a class="docs-heading-anchor" href="#Missing-values">Missing values</a><a id="Missing-values-1"></a><a class="docs-heading-anchor-permalink" href="#Missing-values" title="Permalink"></a></h2><h3 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h3><p>EvoTrees does not handle features having missing values. Proper preprocessing of the data is therefore needed (and a general good practice regardless of the ML model used).</p><p>This includes situations where values may be all non-missing, but where the <code>eltype</code> is <code>Union{Missing,Float64}</code> or <code>Any</code> for example. A conversion using <code>identity</code> is then recommended: </p><pre><code class="language-julia hljs">julia&gt; x = Vector{Union{Missing, Float64}}([1, 2])
2-element Vector{Union{Missing, Float64}}:
 1.0
 2.0

julia&gt; identity.(x)
2-element Vector{Float64}:
 1.0
 2.0</code></pre><p>For dealing with numerical or ordered categorical features containing missing values, a common approach is to first create an <code>Bool</code> variable capturing the info on whether a value is missing:</p><pre><code class="language-julia hljs">using DataFrames
transform!(df, :my_feat =&gt; ByRow(ismissing) =&gt; :my_feat_ismissing)</code></pre><p>Then, the missing values can be imputed (replaced by some default values such as <code>mean</code> or <code>median</code>, or using a more sophisticated approach such as predictions from another model):</p><pre><code class="language-julia hljs">transform!(df, :my_feat =&gt; (x -&gt; coalesce.(x, median(skipmissing(x)))) =&gt; :my_feat)</code></pre><p>For unordered categorical variables, a recode of the missing into a non missing level is sufficient:</p><pre><code class="language-julia hljs">using CategoricalArrays
julia&gt; x = categorical([&quot;a&quot;, &quot;b&quot;, missing])
3-element CategoricalArray{Union{Missing, String},1,UInt32}:
 &quot;a&quot;
 &quot;b&quot;
 missing

julia&gt; x = recode(x, missing =&gt; &quot;missing value&quot;)
3-element CategoricalArray{String,1,UInt32}:
 &quot;a&quot;
 &quot;b&quot;
 &quot;missing value&quot;</code></pre><h3 id="Target"><a class="docs-heading-anchor" href="#Target">Target</a><a id="Target-1"></a><a class="docs-heading-anchor-permalink" href="#Target" title="Permalink"></a></h3><p>Target variable must have its element type <code>&lt;:Real</code>. Only exception is for <code>EvoTreeClassifier</code> for which <code>CategoricalValue</code>, <code>Integer</code>, <code>String</code> and <code>Char</code> are supported.</p><h2 id="Save/Load"><a class="docs-heading-anchor" href="#Save/Load">Save/Load</a><a id="Save/Load-1"></a><a class="docs-heading-anchor-permalink" href="#Save/Load" title="Permalink"></a></h2><pre><code class="language-julia hljs">EvoTrees.save(m, &quot;data/model.bson&quot;)
m = EvoTrees.load(&quot;data/model.bson&quot;);</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="models/">Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Sunday 29 October 2023 04:15">Sunday 29 October 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
